import{c as T,r as f,j as e,y as p,X as V}from"./index-_x4LqXeA.js";import{D as G}from"./download-B9Ll9-Qf.js";import{P as H}from"./power-UR2-Hce3.js";import{P as K}from"./plus-Dr61E6Gh.js";import{E as Q}from"./ellipsis-vertical-CaplzEpS.js";import{C as W}from"./circle-check-asoqXxuc.js";import{C as Y}from"./circle-x-CWS9zTmO.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ee=T("clock-3",Z);function g(...a){return a.filter(Boolean).join(" ")}function F(a){if(!a)return"—";try{const r=new Date(a);return new Intl.DateTimeFormat("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(r)}catch{return"—"}}function te({checked:a,onChange:r,disabled:n}){return e.jsx("button",{type:"button",disabled:n,onClick:()=>r(!a),className:g("relative h-6 w-11 rounded-full border transition",a?"bg-emerald-500/90 border-emerald-400":"bg-slate-800 border-slate-700",n&&"opacity-60 cursor-not-allowed"),"aria-pressed":a,children:e.jsx("span",{className:g("absolute top-[3px] h-4 w-4 rounded-full bg-slate-950 transition",a?"left-6":"left-[3px]")})})}function se({open:a,onClose:r,children:n,title:m}){return a?e.jsxs("div",{className:"fixed inset-0 z-[80]",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:r}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-[420px] bg-white text-slate-900 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b",children:[e.jsx("p",{className:"text-base font-semibold",children:m}),e.jsx("button",{type:"button",onClick:r,className:"rounded-lg p-2 hover:bg-slate-100",children:e.jsx(V,{size:18})})]}),e.jsx("div",{className:"p-5",children:n})]})]}):null}function le({onDelete:a}){const[r,n]=f.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>n(m=>!m),className:"rounded-lg p-2 hover:bg-slate-100/10",children:e.jsx(Q,{size:18,className:"text-slate-400"})}),r?e.jsx("div",{className:"absolute right-0 top-10 w-40 rounded-xl border border-slate-200 bg-white shadow-lg overflow-hidden",children:e.jsx("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-slate-100",onClick:()=>{n(!1),a()},children:"Delete"})}):null]})}function ae({item:a}){const r=a.enabled;return e.jsxs("span",{className:g("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs border",r?"bg-emerald-500/10 text-emerald-700 border-emerald-200":"bg-rose-500/10 text-rose-700 border-rose-200"),children:[r?e.jsx(W,{size:14}):e.jsx(Y,{size:14}),r?"Active":"Off"]})}function me({title:a,typeLabel:r,typeOptions:n,maxAccounts:m,locked:P,lockedReason:L,items:E,onItemsChange:D,onCreate:k,onDelete:y,onToggle:v,uiDebugUnlockAll:O=!1}){var I;const u=O?!1:!!P,[z,U]=f.useState([]),i=E??z,b=D??U,[M,j]=f.useState(!1),[h,R]=f.useState(((I=n[0])==null?void 0:I.value)??""),o=f.useMemo(()=>n.find(t=>t.value===h)??n[0],[n,h]),[N,C]=f.useState({});f.useEffect(()=>{var l;const t={};(l=o==null?void 0:o.fields)==null||l.forEach(s=>t[s.key]=""),C(t)},[h]);const w=i.length,S=!u&&(typeof m=="number"?w<m:!0),A=i.length>0&&i.every(t=>t.enabled),$=async()=>{if(u)return;const t=!A,l=i;b(l.map(s=>({...s,enabled:t})));try{p.success(t?"All APIs turned ON":"All APIs turned OFF")}catch{b(l),p.error("Failed to toggle all")}},_=async(t,l)=>{var c;if(u)return;const s=i;b(s.map(x=>x.id===t?{...x,enabled:l}:x));try{await(v==null?void 0:v(t,l))}catch(x){b(s),p.error(((c=x==null?void 0:x.data)==null?void 0:c.message)||"Failed to update")}},q=async t=>{var s;const l=i;b(l.filter(c=>c.id!==t));try{await(y==null?void 0:y(t)),p.success("Deleted")}catch(c){b(l),p.error(((s=c==null?void 0:c.data)==null?void 0:s.message)||"Failed to delete")}},B=()=>{const t=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),l=URL.createObjectURL(t),s=document.createElement("a");s.href=l,s.download=`${a.replace(/\s+/g,"_").toLowerCase()}_export.json`,s.click(),URL.revokeObjectURL(l)},X=async()=>{var c,x;if(u)return;const t=((c=o==null?void 0:o.fields)==null?void 0:c.filter(d=>d.required))??[];for(const d of t)if(!String(N[d.key]??"").trim())return p.error(`${d.label} is required`);const l=String(N.apiName??"").trim()||`${(o==null?void 0:o.label)??"API"} ${w+1}`,s={...N};delete s.apiName;try{let d;k?d=await k({type:h,apiName:l,meta:s}):d={id:`${Date.now()}`,type:h,apiName:l,enabled:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),meta:s},b([d,...i]),p.success("API added"),j(!1)}catch(d){p.error(((x=d==null?void 0:d.data)==null?void 0:x.message)||"Failed to add API")}};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-slate-100",children:a}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:typeof m=="number"?e.jsxs(e.Fragment,{children:["Accounts used:"," ",e.jsx("span",{className:"text-slate-200 font-semibold",children:w})," /"," ",e.jsx("span",{className:"text-slate-200 font-semibold",children:m})]}):e.jsx(e.Fragment,{children:"Manage your connected APIs"})}),u?e.jsx("p",{className:"text-xs text-amber-300 mt-1",children:L||"Locked by plan"}):null]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("button",{type:"button",onClick:B,className:"inline-flex items-center gap-2 rounded-xl border border-slate-800 bg-slate-900/60 px-4 py-2 text-xs text-slate-200 hover:bg-slate-900/80",children:[e.jsx(G,{size:14}),"Export"]}),e.jsxs("button",{type:"button",disabled:u||i.length===0,onClick:$,className:g("inline-flex items-center gap-2 rounded-xl px-4 py-2 text-xs font-semibold",A?"bg-rose-500/15 text-rose-200 border border-rose-400/30":"bg-emerald-500/15 text-emerald-200 border border-emerald-400/30",(u||i.length===0)&&"opacity-60 cursor-not-allowed"),children:[e.jsx(H,{size:14}),"ALL API ON / OFF"]}),e.jsxs("button",{type:"button",disabled:!S,onClick:()=>j(!0),className:g("inline-flex items-center gap-2 rounded-xl bg-indigo-500 px-4 py-2 text-xs font-semibold text-white hover:bg-indigo-400",!S&&"opacity-60 cursor-not-allowed"),children:[e.jsx(K,{size:14}),"Add New Api"]})]})]}),i.length===0?e.jsxs("div",{className:"rounded-2xl border border-slate-800 bg-slate-900/40 p-6 text-slate-300",children:["No APIs added yet. Click ",e.jsx("b",{children:"Add New Api"}),"."]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:i.map(t=>{const l=n.find(s=>s.value===t.type);return e.jsxs("div",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-semibold text-slate-100",children:(l==null?void 0:l.label)??t.type}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Api Name :"}),e.jsx("p",{className:"text-sm text-slate-200 font-medium",children:t.apiName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{checked:t.enabled,onChange:s=>_(t.id,s),disabled:u}),e.jsx(le,{onDelete:()=>q(t.id)})]})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-slate-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Created :"}),e.jsx("span",{children:F(t.createdAt)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Updated :"}),e.jsx("span",{children:F(t.updatedAt)})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-lg border border-indigo-300/30 bg-indigo-500/10 px-3 py-1 text-xs text-indigo-200",children:["Api Id : ",String(t.id)]}),e.jsx(ae,{item:t})]})]},String(t.id))})}),e.jsx(se,{open:M,onClose:()=>j(!1),title:"Add New API",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-semibold text-indigo-600",children:["SELECT ",r]}),e.jsx("select",{value:h,onChange:t=>R(t.target.value),className:"mt-2 w-full rounded-lg border border-indigo-300 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-indigo-200",children:n.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),((o==null?void 0:o.fields)??[]).map(t=>e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-600",children:t.label.toUpperCase()}),e.jsx("input",{type:t.type==="password"?"password":"text",value:N[t.key]??"",onChange:l=>C(s=>({...s,[t.key]:l.target.value})),placeholder:t.placeholder,className:"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-indigo-100"})]},t.key)),e.jsxs("div",{className:"pt-2 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:X,className:"rounded-lg bg-indigo-500 px-6 py-2 text-sm font-semibold text-white hover:bg-indigo-400",children:"Submit"}),e.jsx("button",{type:"button",onClick:()=>j(!1),className:"rounded-lg bg-rose-100 px-6 py-2 text-sm font-semibold text-rose-600 hover:bg-rose-200",children:"Cancel"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 pt-2",children:[e.jsx(ee,{size:14}),"Secrets are hidden in UI; store encrypted server-side."]})]})})]})}export{me as A};
