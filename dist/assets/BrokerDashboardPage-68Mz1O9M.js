import{c as ce,d as de,k as xe,r,j as e,n as Y,m as me,y as u}from"./index-1Vb8v_ID.js";import{A as he}from"./arrow-left-CcCuhpea.js";import{A as ue}from"./activity-B4Zpwe1A.js";import{R as I}from"./refresh-cw-D8nMIIN4.js";import{C as pe}from"./chart-candlestick-BUbcm7oO.js";import{W as G}from"./wallet-CgQ3fidS.js";import{F as je}from"./funnel-DOCpb7HT.js";import{C as be}from"./clock-q7pNj9uF.js";import{C as Q}from"./calendar-D8uLdbtL.js";import{C as ge,a as fe}from"./chevron-right-CrW2kYWF.js";import{C as Ne}from"./circle-x-B3jpzO71.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],R=ce("history",ye),ve=de.injectEndpoints({endpoints:s=>({getTradingviewAlertsHistory:s.query({query:l=>({url:"/tradingview/alerts/history",method:"GET",params:l}),providesTags:["TradingviewAlertsHistory"]})}),overrideExisting:!1}),{useGetTradingviewAlertsHistoryQuery:we}=ve,p="mt-1 w-full rounded-xl border border-slate-700 bg-slate-950/60 px-3 py-2.5 text-sm text-slate-50 placeholder:text-slate-500 outline-none transition-all duration-200 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-400",S="rounded-2xl border border-slate-800 bg-slate-900/40 p-6";function Ce(){const s=new Date;return s.setHours(0,0,0,0),s.toISOString()}function Se(){const s=new Date;return s.setHours(23,59,59,999),s.toISOString()}function W(s){const l=new Date(s),i=w=>String(w).padStart(2,"0");return`${l.getFullYear()}-${i(l.getMonth()+1)}-${i(l.getDate())}T${i(l.getHours())}:${i(l.getMinutes())}`}function K(s){return new Date(s).toISOString()}function d(...s){return s.filter(Boolean).join(" ")}function B({children:s,tone:l="slate"}){const i=l==="emerald"?"bg-emerald-500/15 text-emerald-300 border-emerald-500/25":l==="rose"?"bg-rose-500/15 text-rose-300 border-rose-500/25":l==="yellow"?"bg-yellow-500/15 text-yellow-300 border-yellow-500/25":"bg-slate-500/10 text-slate-200 border-slate-500/20";return e.jsx("span",{className:d("inline-flex items-center rounded-full border px-2.5 py-1 text-[11px] font-semibold",i),children:s})}function Te(s){const l=String(s||"").toUpperCase();return l.includes("BUY")||l.includes("LONG")?"emerald":l.includes("SELL")||l.includes("SHORT")?"rose":l.includes("CLOSE")?"yellow":"slate"}function Ae(s){if(s==null)return null;const l=Number(s);return Number.isFinite(l)?l:null}function v(s){const l=Ae(s);return l===null?"—":l.toLocaleString(void 0,{maximumFractionDigits:8})}function T(s){if(!s)return{date:"—",time:"—"};const l=new Date(s);return{date:l.toLocaleDateString(),time:l.toLocaleTimeString()}}function Le(s){return{id:s==null?void 0:s.id,jobId:(s==null?void 0:s.jobid)??(s==null?void 0:s.jobId),ticker:s==null?void 0:s.ticker,exchange:s==null?void 0:s.exchange,interval:s==null?void 0:s.interval,barTime:(s==null?void 0:s.bartime)??(s==null?void 0:s.barTime),alertTime:(s==null?void 0:s.alerttime)??(s==null?void 0:s.alertTime),open:s==null?void 0:s.open,close:s==null?void 0:s.close,high:s==null?void 0:s.high,low:s==null?void 0:s.low,volume:s==null?void 0:s.volume,currency:s==null?void 0:s.currency,basecurrency:s==null?void 0:s.basecurrency,createdAt:(s==null?void 0:s.createdat)??(s==null?void 0:s.createdAt),updatedAt:(s==null?void 0:s.updatedat)??(s==null?void 0:s.updatedAt),action:(s==null?void 0:s.action)??null,...s}}const ke=[{id:"pos_1",symbol:"BTCUSDT",side:"BUY",qty:.01,entryPrice:43e3,currentPrice:43120,pnl:1.2,openedAt:new Date().toISOString(),accountLabel:"Account #1"}],Oe=[{id:"hist_1",symbol:"BTCUSDT",side:"SELL",qty:.01,entryPrice:43150,exitPrice:43080,pnl:.7,openedAt:new Date(Date.now()-60*60*1e3).toISOString(),closedAt:new Date(Date.now()-30*60*1e3).toISOString(),accountLabel:"Account #1"}];function a({children:s}){return e.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-400",children:s})}function n({children:s,className:l=""}){return e.jsx("td",{className:d("px-3 py-2 text-sm text-slate-100",l),children:s})}function U({text:s}){return e.jsxs("div",{className:"mt-3 rounded-xl border border-slate-800 bg-slate-900/50 p-3 text-xs text-slate-400",children:[e.jsx("span",{className:"text-slate-200 font-semibold",children:"UI Only:"})," ",s]})}function He(){var J;const s=xe(),l=()=>{window.history.length>1?s(-1):s("/profile")},[i,w]=r.useState("lastMinutes"),[x,A]=r.useState("signals"),[L,F]=r.useState(60),[m,o]=r.useState(1),[f,$]=r.useState(20),[k,X]=r.useState(Ce()),[O,Z]=r.useState(Se()),[E,ee]=r.useState(""),[M,se]=r.useState(""),te=r.useMemo(()=>i==="lastMinutes"?{lastMinutes:L,page:m,limit:f}:{from:k,to:O,ticker:E.trim()||void 0,exchange:M.trim()||void 0,page:m,limit:f},[i,L,m,f,k,O,E,M]),{data:D,isLoading:le,isFetching:ae,isError:ne,error:j,refetch:ie}=we(te),h=(D==null?void 0:D.data)??{},H=Array.isArray(h==null?void 0:h.rows)?h.rows:[],C=r.useMemo(()=>H.map(Le),[H]),_=Number((h==null?void 0:h.total)??C.length),q=Math.max(1,Math.ceil(_/Math.max(1,f))),N=le||ae,P=ke,z=Oe,oe=async()=>{try{await ie(),u.success("Refreshed")}catch{u.error("Refresh failed")}},V=async t=>{try{await navigator.clipboard.writeText(JSON.stringify(t,null,2)),u.success("Copied JSON")}catch{u.error("Copy failed")}},re=async()=>{u.info("Close trade API not connected yet (UI only).")};return e.jsx("div",{className:"min-h-screen px-4 pt-16 md:pt-28 md:px-6 pb-10 bg-slate-950 text-slate-100",children:e.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-8",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("button",{onClick:l,className:"inline-flex items-center gap-2 rounded-full bg-slate-800 px-4 py-2 text-sm text-slate-100 hover:bg-slate-700",children:[e.jsx(he,{size:16}),"Back"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(ue,{className:"text-emerald-400",size:20}),"Trading Workspace"]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Signals (TradingView alerts) + Open trades + Trade history."})]})]}),e.jsxs("button",{onClick:oe,className:"inline-flex items-center gap-2 rounded-full bg-slate-800 px-4 py-2 text-sm hover:bg-slate-700",children:[e.jsx(I,{size:16}),N?"Refreshing...":"Refresh"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>A("signals"),className:d("inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm border transition",x==="signals"?"bg-emerald-500 text-slate-950 border-emerald-500":"bg-slate-900 text-slate-300 border-slate-700 hover:border-slate-500"),children:[e.jsx(pe,{size:16}),"Signals"]}),e.jsxs("button",{onClick:()=>A("open"),className:d("inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm border transition",x==="open"?"bg-emerald-500 text-slate-950 border-emerald-500":"bg-slate-900 text-slate-300 border-slate-700 hover:border-slate-500"),children:[e.jsx(G,{size:16}),"Current Trades"]}),e.jsxs("button",{onClick:()=>A("history"),className:d("inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm border transition",x==="history"?"bg-emerald-500 text-slate-950 border-emerald-500":"bg-slate-900 text-slate-300 border-slate-700 hover:border-slate-500"),children:[e.jsx(R,{size:16}),"Trades History"]})]}),x==="signals"&&e.jsxs("section",{className:S,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-200",children:[e.jsx(je,{size:16,className:"text-slate-400"}),"Signals Filters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{w("lastMinutes"),o(1)},className:d("rounded-full px-4 py-2 text-sm border transition",i==="lastMinutes"?"bg-emerald-500 text-slate-950 border-emerald-500":"bg-slate-900 text-slate-300 border-slate-700 hover:border-slate-500"),children:"Last Minutes"}),e.jsx("button",{onClick:()=>{w("range"),o(1)},className:d("rounded-full px-4 py-2 text-sm border transition",i==="range"?"bg-emerald-500 text-slate-950 border-emerald-500":"bg-slate-900 text-slate-300 border-slate-700 hover:border-slate-500"),children:"Date Range"})]})]}),e.jsx("div",{className:"mt-5 grid gap-4 md:grid-cols-4",children:i==="lastMinutes"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(be,{size:14,className:"text-slate-400"}),"Last Minutes"]}),e.jsx("input",{type:"number",min:1,value:L,onChange:t=>{const c=Number(t.target.value);F(Number.isFinite(c)?c:60),o(1)},className:p,placeholder:"60"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-300",children:"Page"}),e.jsx("input",{type:"number",min:1,value:m,onChange:t=>o(Math.max(1,Number(t.target.value)||1)),className:p})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-300",children:"Limit"}),e.jsx("input",{type:"number",min:1,max:200,value:f,onChange:t=>$(Math.max(1,Number(t.target.value)||20)),className:p})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsx("button",{onClick:()=>{F(60),o(1),$(20)},className:"w-full rounded-xl bg-slate-800 px-4 py-2.5 text-sm hover:bg-slate-700",children:"Reset"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(Q,{size:14,className:"text-slate-400"}),"From"]}),e.jsx("input",{type:"datetime-local",value:W(k),onChange:t=>{X(K(t.target.value)),o(1)},className:p})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(Q,{size:14,className:"text-slate-400"}),"To"]}),e.jsx("input",{type:"datetime-local",value:W(O),onChange:t=>{Z(K(t.target.value)),o(1)},className:p})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(Y,{size:14,className:"text-slate-400"}),"Ticker (optional)"]}),e.jsx("input",{value:E,onChange:t=>{ee(t.target.value),o(1)},className:p,placeholder:"BTCUSDT"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(Y,{size:14,className:"text-slate-400"}),"Exchange (optional)"]}),e.jsx("input",{value:M,onChange:t=>{se(t.target.value),o(1)},className:p,placeholder:"BINANCE"})]})]})}),ne&&e.jsxs("div",{className:"mt-4 rounded-xl border border-rose-500/30 bg-rose-500/10 p-3 text-sm text-rose-200",children:["Failed to load signals.",e.jsx("span",{className:"ml-2 text-rose-300/90",children:((J=j==null?void 0:j.data)==null?void 0:J.message)||(j==null?void 0:j.message)||""})]})]}),x==="signals"&&e.jsxs("section",{className:S,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:16,className:"text-slate-400"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Signals (TradingView Alerts)"}),e.jsx("span",{className:"text-xs text-slate-500",children:N?"Loading…":`${C.length} rows • total ${_}`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>o(t=>Math.max(1,t-1)),disabled:m<=1||N,className:"inline-flex items-center gap-1 rounded-xl border border-slate-700 bg-slate-900 px-3 py-2 text-xs text-slate-200 hover:bg-slate-800 disabled:opacity-50",children:[e.jsx(ge,{size:14})," Prev"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["Page ",e.jsx("span",{className:"text-slate-200 font-semibold",children:m})," /"," ",e.jsx("span",{className:"text-slate-200 font-semibold",children:q})]}),e.jsxs("button",{onClick:()=>o(t=>t+1),disabled:N||m>=q,className:"inline-flex items-center gap-1 rounded-xl border border-slate-700 bg-slate-900 px-3 py-2 text-xs text-slate-200 hover:bg-slate-800 disabled:opacity-50",children:["Next ",e.jsx(fe,{size:14})]})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-800",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"bg-slate-900/70",children:e.jsxs("tr",{children:[e.jsx(a,{children:"Action"}),e.jsx(a,{children:"Ticker"}),e.jsx(a,{children:"Exchange"}),e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Time"}),e.jsx(a,{children:"Close"}),e.jsx(a,{children:"Interval"}),e.jsx(a,{children:"Job"}),e.jsx(a,{children:"Actions"})]})}),e.jsx("tbody",{children:N?[...Array(6)].map((t,c)=>e.jsx("tr",{className:"border-t border-slate-800",children:e.jsx("td",{className:"px-3 py-3",colSpan:9,children:e.jsx("div",{className:"h-4 w-full animate-pulse rounded bg-slate-800/70"})})},c)):C.length===0?e.jsx("tr",{className:"border-t border-slate-800",children:e.jsx("td",{className:"px-3 py-6 text-slate-400",colSpan:9,children:"No signals found for selected filters."})}):C.map((t,c)=>{const y=Te(t==null?void 0:t.action),{date:b,time:g}=T((t==null?void 0:t.alertTime)||(t==null?void 0:t.createdAt));return e.jsxs(me.tr,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"border-t border-slate-800 hover:bg-slate-900/30",children:[e.jsx(n,{children:e.jsx(B,{tone:y,children:String((t==null?void 0:t.action)||"—").toUpperCase()})}),e.jsx(n,{className:"font-semibold",children:(t==null?void 0:t.ticker)||"—"}),e.jsx(n,{className:"text-slate-200",children:(t==null?void 0:t.exchange)||"—"}),e.jsx(n,{className:"text-slate-300",children:b}),e.jsx(n,{className:"text-slate-300",children:g}),e.jsx(n,{children:v(t==null?void 0:t.close)}),e.jsx(n,{className:"text-slate-300",children:(t==null?void 0:t.interval)||"—"}),e.jsx(n,{className:"text-slate-400",children:t!=null&&t.jobId?`#${t==null?void 0:t.jobId}`:"—"}),e.jsx(n,{className:"text-right",children:e.jsx("button",{onClick:()=>V(t),className:"rounded-xl bg-slate-800 px-3 py-1.5 text-xs text-slate-200 hover:bg-slate-700",children:"Copy JSON"})})]},(t==null?void 0:t.id)??`${c}`)})})]})}),e.jsx(U,{text:"This section is live (TradingView alerts history API is connected). Action will show once your backend sends action field (BUY/SELL/CLOSE)."})]}),x==="open"&&e.jsxs("section",{className:S,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{size:16,className:"text-slate-400"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Current Trades"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[P.length," open"]})]}),e.jsxs("button",{onClick:()=>u.info("Open positions API not connected yet (UI only)."),className:"inline-flex items-center gap-2 rounded-full bg-slate-800 px-4 py-2 text-sm hover:bg-slate-700",children:[e.jsx(I,{size:16}),"Refresh"]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-800",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"bg-slate-900/70",children:e.jsxs("tr",{children:[e.jsx(a,{children:"Side"}),e.jsx(a,{children:"Symbol"}),e.jsx(a,{children:"Qty"}),e.jsx(a,{children:"Entry"}),e.jsx(a,{children:"Current"}),e.jsx(a,{children:"PnL"}),e.jsx(a,{children:"Opened"}),e.jsx(a,{children:"Account"}),e.jsx(a,{children:"Actions"})]})}),e.jsx("tbody",{children:P.length===0?e.jsx("tr",{className:"border-t border-slate-800",children:e.jsx("td",{colSpan:9,className:"px-3 py-6 text-slate-400",children:"No open trades."})}):P.map(t=>{const c=t.side==="BUY"?"emerald":"rose",{date:y,time:b}=T(t.openedAt),g=t.pnl>=0?"text-emerald-300":"text-rose-300";return e.jsxs("tr",{className:"border-t border-slate-800 hover:bg-slate-900/30",children:[e.jsx(n,{children:e.jsx(B,{tone:c,children:t.side})}),e.jsx(n,{className:"font-semibold",children:t.symbol}),e.jsx(n,{children:t.qty}),e.jsx(n,{children:v(t.entryPrice)}),e.jsx(n,{children:v(t.currentPrice)}),e.jsx(n,{className:d("font-semibold",g),children:t.pnl>=0?`+${t.pnl}`:`${t.pnl}`}),e.jsxs(n,{className:"text-slate-300",children:[y," • ",b]}),e.jsx(n,{className:"text-slate-400",children:t.accountLabel||"—"}),e.jsx(n,{className:"text-right",children:e.jsxs("button",{onClick:re,className:"inline-flex items-center gap-2 rounded-xl bg-rose-500/15 border border-rose-500/25 px-3 py-1.5 text-xs text-rose-200 hover:bg-rose-500/20",children:[e.jsx(Ne,{size:14}),"Close"]})})]},t.id)})})]})}),e.jsx(U,{text:"Open positions + close-trade endpoints are not integrated yet. Button currently shows a toast. Later we’ll connect: GET /positions (open) + POST /positions/:id/close."})]}),x==="history"&&e.jsxs("section",{className:S,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:16,className:"text-slate-400"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Trades History"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[z.length," records"]})]}),e.jsxs("button",{onClick:()=>u.info("Trade history API not connected yet (UI only)."),className:"inline-flex items-center gap-2 rounded-full bg-slate-800 px-4 py-2 text-sm hover:bg-slate-700",children:[e.jsx(I,{size:16}),"Refresh"]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-800",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"bg-slate-900/70",children:e.jsxs("tr",{children:[e.jsx(a,{children:"Side"}),e.jsx(a,{children:"Symbol"}),e.jsx(a,{children:"Qty"}),e.jsx(a,{children:"Entry"}),e.jsx(a,{children:"Exit"}),e.jsx(a,{children:"PnL"}),e.jsx(a,{children:"Opened"}),e.jsx(a,{children:"Closed"}),e.jsx(a,{children:"Account"}),e.jsx(a,{children:"Actions"})]})}),e.jsx("tbody",{children:z.length===0?e.jsx("tr",{className:"border-t border-slate-800",children:e.jsx("td",{colSpan:10,className:"px-3 py-6 text-slate-400",children:"No trade history yet."})}):z.map(t=>{const c=t.side==="BUY"?"emerald":"rose",y=t.pnl>=0?"text-emerald-300":"text-rose-300",b=T(t.openedAt),g=T(t.closedAt);return e.jsxs("tr",{className:"border-t border-slate-800 hover:bg-slate-900/30",children:[e.jsx(n,{children:e.jsx(B,{tone:c,children:t.side})}),e.jsx(n,{className:"font-semibold",children:t.symbol}),e.jsx(n,{children:t.qty}),e.jsx(n,{children:v(t.entryPrice)}),e.jsx(n,{children:v(t.exitPrice)}),e.jsx(n,{className:d("font-semibold",y),children:t.pnl>=0?`+${t.pnl}`:`${t.pnl}`}),e.jsxs(n,{className:"text-slate-300",children:[b.date," • ",b.time]}),e.jsxs(n,{className:"text-slate-300",children:[g.date," • ",g.time]}),e.jsx(n,{className:"text-slate-400",children:t.accountLabel||"—"}),e.jsx(n,{className:"text-right",children:e.jsx("button",{onClick:()=>V(t),className:"rounded-xl bg-slate-800 px-3 py-1.5 text-xs text-slate-200 hover:bg-slate-700",children:"Copy JSON"})})]},t.id)})})]})}),e.jsx(U,{text:"Trade history endpoint not integrated yet. Later we’ll connect: GET /trades/history?from&to&page&limit."})]})]})})}export{He as default};
