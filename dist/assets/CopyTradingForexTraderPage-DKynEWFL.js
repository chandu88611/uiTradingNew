import{c as M,j as e,S as C,r as o,s as O,y as k}from"./index-_x4LqXeA.js";import{c as u,i as L,a as S,b as I,d as w,s as F,D as T,S as E,p as R,F as W}from"./ForexCopyAccountsPanel-DjbHKwxr.js";import{S as U}from"./sliders-horizontal-B9MMwDiR.js";import{L as z}from"./layers-Bf8l_RcR.js";import"./ellipsis-vertical-CaplzEpS.js";import"./download-B9Ll9-Qf.js";import"./power-UR2-Hce3.js";import"./refresh-cw-DbxyBI9D.js";import"./plus-Dr61E6Gh.js";import"./crown-BIlIHcvw.js";import"./save-CpCvopvD.js";import"./trash-2-BfimlZ-T.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]],_=M("webhook",H),B=[{planId:"fx-pro-001",planName:"Forex Pro • Monthly",tier:"PRO",executionAllowed:!0,limits:{maxConnectedAccounts:3,maxActiveStrategies:4,maxDailyTrades:40,maxLotPerTrade:2},webhook:{endpointUrl:"https://api.yourapp.com/webhook/forex/fx-pro-001",secretMasked:"sk_live_****_PRO"}},{planId:"fx-elite-001",planName:"Forex Elite • Yearly",tier:"ELITE",executionAllowed:!0,limits:{maxConnectedAccounts:10,maxActiveStrategies:12,maxDailyTrades:200,maxLotPerTrade:5},webhook:{endpointUrl:"https://api.yourapp.com/webhook/forex/fx-elite-001",secretMasked:"sk_live_****_ELITE"}}],G={"fx-pro-001":[{id:"pro-breakout-1",name:"London Breakout",description:"Breakout entries around London open with session filters.",tags:["Session","Breakout","Stops"],risk:"MEDIUM"},{id:"pro-trend-1",name:"Trend Follow (EMA)",description:"Trend continuation using EMA alignment + pullback entry.",tags:["Trend","EMA","Pullback"],risk:"LOW"},{id:"pro-scalp-1",name:"Scalper (Fast)",description:"High-frequency setup with strict slippage and spread guards.",tags:["Scalp","Fast","Spread guard"],risk:"HIGH"}],"fx-elite-001":[{id:"elite-grid-1",name:"Smart Grid (Hedged)",description:"Adaptive grid with exposure caps and kill-switch integration.",tags:["Grid","Caps","Hedge"],risk:"HIGH"},{id:"elite-news-1",name:"News Filter Momentum",description:"Momentum signals with configurable news blackout windows.",tags:["News","Momentum","Filter"],risk:"MEDIUM"},{id:"elite-mean-1",name:"Mean Reversion",description:"Reversion on extreme deviation with time-based exit rules.",tags:["Mean","Revert","Exit rules"],risk:"LOW"},{id:"elite-trend-2",name:"Trend Follow (Multi-TF)",description:"Higher timeframe bias + lower timeframe trigger execution.",tags:["Trend","Multi-TF"],risk:"LOW"}]},J={"fx-pro-001":{pauseEnabled:!1,pauseUntil:"",maxLossPerDay:2500,minProfitPerDay:500,maxDailyTrades:40,maxOpenPositions:6,maxLotPerTrade:2,killSwitch:!1},"fx-elite-001":{pauseEnabled:!1,pauseUntil:"",maxLossPerDay:1e4,minProfitPerDay:2e3,maxDailyTrades:200,maxOpenPositions:20,maxLotPerTrade:5,killSwitch:!1}};function Y(l){return{planId:l,market:"FOREX",signal:{id:"tv_alert_123",symbol:"EURUSD",side:"BUY",orderType:"MARKET",lot:.1,sl:15,tp:25,comment:"TradingView alert"},meta:{sentAt:new Date().toISOString(),source:"TRADINGVIEW"}}}function K({plans:l,selectedPlanId:i,onChangePlan:t,accountsUsed:s,enabledStrategyCount:m,planSignals:c,onOpenWebhook:n,onOpenStrategies:a,onOpenSafety:p}){const r=l.find(d=>d.planId===i)??null,h=r?c[r.planId]:void 0,b=!!(h!=null&&h.strategiesEnabled),g=!!(h!=null&&h.webhookEnabled),N=(r==null?void 0:r.limits.maxConnectedAccounts)??0,x=(r==null?void 0:r.limits.maxActiveStrategies)??0;return e.jsx("div",{className:u(F,"p-5"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"Plan in use"}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Select plan → limits apply per plan. Webhook + Strategies are configured per plan."}),e.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-300",children:"Selected Plan"}),e.jsx("select",{className:L.replace("mt-2","mt-2"),value:i,onChange:d=>t(d.target.value),disabled:l.length<=1,children:l.map(d=>e.jsx("option",{value:d.planId,children:d.planName},d.planId))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-end",children:[e.jsxs("span",{className:u(S,"text-slate-200 bg-white/5 border-white/10"),children:["Accounts: ",e.jsx("b",{className:"text-slate-100",children:s})," /"," ",e.jsx("b",{className:"text-slate-100",children:N||"—"})]}),e.jsxs("span",{className:u(S,b?"text-emerald-200 bg-emerald-500/10 border-emerald-500/20":"text-slate-200 bg-white/5 border-white/10"),children:["Strategies: ",b?"ON":"OFF"," ",e.jsxs("span",{className:"text-slate-300",children:["(",m,"/",x||"—",")"]})]}),e.jsxs("span",{className:u(S,g?"text-emerald-200 bg-emerald-500/10 border-emerald-500/20":"text-slate-200 bg-white/5 border-white/10"),children:["Webhook: ",g?"ON":"OFF"]}),e.jsxs("span",{className:u(S,r!=null&&r.executionAllowed?"text-emerald-200 bg-emerald-500/10 border-emerald-500/20":"text-slate-200 bg-white/5 border-white/10"),children:[e.jsx(C,{size:14}),r!=null&&r.executionAllowed?"Execution Enabled":"Execution Disabled"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{type:"button",className:u(w,I),onClick:p,disabled:!r,children:[e.jsx(U,{size:14}),"Safety"]}),e.jsxs("button",{type:"button",className:u(w,I),onClick:n,disabled:!r,children:[e.jsx(_,{size:14}),"Webhook"]}),e.jsxs("button",{type:"button",className:u(w,I),onClick:a,disabled:!r,children:[e.jsx(z,{size:14}),"Strategies"]})]})]})})}function V({open:l,onClose:i,plan:t,planSignals:s,setPlanSignals:m}){var p;const c=t?!!((p=s[t.planId])!=null&&p.webhookEnabled):!1,n=o.useMemo(()=>t?Y(t.planId):null,[t]),a=async r=>{try{await navigator.clipboard.writeText(r),k.success("Copied")}catch{k.error("Copy failed")}};return t?e.jsx(T,{open:l,title:"Webhook (TradingView)",onClose:i,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-xl border border-slate-200 p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enable Webhook"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Webhook is per-plan. Keep it OFF if you only use built-in strategies."})]}),e.jsx(E,{checked:c,onChange:r=>{var h;m({...s,[t.planId]:{strategiesEnabled:!!((h=s[t.planId])!=null&&h.strategiesEnabled),webhookEnabled:r}})}})]})}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"WEBHOOK URL"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("input",{className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",value:t.webhook.endpointUrl,readOnly:!0}),e.jsxs("button",{type:"button",className:u(w,"text-slate-700 border border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>a(t.webhook.endpointUrl),children:[e.jsx(O,{size:14}),"Copy"]})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600 flex items-center gap-2",children:[e.jsx(C,{size:14,className:"text-emerald-600"}),"Secret: ",e.jsx("span",{className:"font-semibold",children:t.webhook.secretMasked}),e.jsx("span",{className:"text-slate-400",children:"(masked)"})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"TRADINGVIEW ALERT JSON"}),e.jsx("div",{className:"text-[11px] text-slate-500 mt-1",children:"Paste this JSON in TradingView alert message."}),e.jsx("pre",{className:"mt-3 max-h-[260px] overflow-auto rounded-lg bg-slate-950 text-slate-100 p-3 text-[12px]",children:JSON.stringify(n,null,2)}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{type:"button",className:u(w,"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50"),onClick:()=>a(JSON.stringify(n,null,2)),children:[e.jsx(O,{size:14}),"Copy JSON"]})})]}),e.jsx("div",{className:"text-[11px] text-slate-500",children:"Tip: Keep webhook enabled **only for the plan you actually use**."})]})}):null}function X(l){return l==="LOW"?"bg-emerald-100 text-emerald-700 border-emerald-200":l==="MEDIUM"?"bg-amber-100 text-amber-700 border-amber-200":"bg-rose-100 text-rose-700 border-rose-200"}function Z({open:l,onClose:i,plan:t,strategyDefs:s,planSignals:m,setPlanSignals:c,selections:n,setSelections:a}){const p=o.useMemo(()=>t?s[t.planId]??[]:[],[t,s]);if(!t)return null;const r=m[t.planId],h=!!(r!=null&&r.strategiesEnabled),b=n[t.planId]??[],g=t.limits.maxActiveStrategies,N=x=>{const d=new Set(b),j=d.has(x);if(!j&&g>0&&d.size>=g){k.error(`Max active strategies reached (${g}) for this plan`);return}j?d.delete(x):d.add(x),a({...n,[t.planId]:Array.from(d)})};return e.jsx(T,{open:l,title:"Strategies",onClose:i,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-xl border border-slate-200 p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enable Strategies"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Strategies are per-plan. You can enable multiple strategies (limited by plan)."})]}),e.jsx(E,{checked:h,onChange:x=>{var d;c({...m,[t.planId]:{strategiesEnabled:x,webhookEnabled:!!((d=m[t.planId])!=null&&d.webhookEnabled)}})}})]})}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"AVAILABLE STRATEGIES"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Enabled: ",e.jsx("b",{children:b.length})," / ",e.jsx("b",{children:g||"—"})]})]}),p.length===0?e.jsx("div",{className:"mt-3 text-sm text-slate-500",children:"No strategies for this plan."}):e.jsx("div",{className:"mt-3 space-y-2",children:p.map(x=>{const d=b.includes(x.id);return e.jsx("button",{type:"button",onClick:()=>N(x.id),className:u("w-full rounded-xl border p-3 text-left transition",d?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:x.name}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:x.description}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("span",{className:u("inline-flex items-center rounded-full border px-2 py-0.5 text-[11px]",X(x.risk)),children:x.risk}),x.tags.map(j=>e.jsx("span",{className:"inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px] text-slate-700",children:j},j))]})]}),e.jsx("div",{className:u("mt-1 h-5 w-10 rounded-full border p-[2px] flex items-center",d?"bg-emerald-100 border-emerald-200 justify-end":"bg-slate-100 border-slate-200 justify-start"),children:e.jsx("div",{className:u("h-4 w-4 rounded-full",d?"bg-emerald-500":"bg-slate-400")})})]})},x.id)})})]}),e.jsx("div",{className:"text-[11px] text-slate-500",children:"Rule: Strategies are tied to this plan. You can’t enable strategies from another plan here."})]})})}function q({open:l,onClose:i,plan:t,safety:s,setSafety:m}){if(!t)return null;const c=s[t.planId],n=a=>{m({...s,[t.planId]:{...c,...a}})};return e.jsx(T,{open:l,title:"Safety Controls",onClose:i,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pause trading"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Stops execution temporarily (per plan)."})]}),e.jsx(E,{checked:!!c.pauseEnabled,onChange:a=>n({pauseEnabled:a})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"PAUSE UNTIL (optional)"}),e.jsx("input",{type:"datetime-local",className:"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",value:(c.pauseUntil??"").slice(0,16),onChange:a=>n({pauseUntil:a.target.value?new Date(a.target.value).toISOString():""}),disabled:!c.pauseEnabled})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Daily guardrails"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"If max loss hit → disable execution. If min profit hit → optionally stop for the day."}),e.jsxs("div",{className:"mt-3 grid gap-3 grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"MAX LOSS / DAY"}),e.jsx("input",{type:"number",className:"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",value:c.maxLossPerDay,onChange:a=>n({maxLossPerDay:Number(a.target.value||0)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"MIN PROFIT / DAY"}),e.jsx("input",{type:"number",className:"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",value:c.minProfitPerDay,onChange:a=>n({minProfitPerDay:Number(a.target.value||0)})})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Limits"}),e.jsxs("div",{className:"mt-3 grid gap-3 grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"MAX DAILY TRADES"}),e.jsx("input",{type:"number",className:"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",value:c.maxDailyTrades,onChange:a=>n({maxDailyTrades:Number(a.target.value||0)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"MAX OPEN POSITIONS"}),e.jsx("input",{type:"number",className:"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",value:c.maxOpenPositions,onChange:a=>n({maxOpenPositions:Number(a.target.value||0)})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"MAX LOT / TRADE"}),e.jsx("input",{type:"number",className:"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",value:c.maxLotPerTrade,onChange:a=>n({maxLotPerTrade:Number(a.target.value||0)})})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-3",children:[e.jsx("div",{className:"text-sm font-semibold text-rose-800",children:"Kill switch"}),e.jsx("div",{className:"text-xs text-rose-700 mt-1",children:"Emergency stop. Disables all execution for this plan immediately."}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-rose-800 font-semibold",children:c.killSwitch?"ENABLED":"OFF"}),e.jsx(E,{checked:!!c.killSwitch,onChange:a=>n({killSwitch:a})})]})]})]})})}function v(l,i){try{const t=localStorage.getItem(l);return t?JSON.parse(t):i}catch{return i}}function y(l,i){try{localStorage.setItem(l,JSON.stringify(i))}catch{}}function $(l,i){return i[l]?i:{...i,[l]:{strategiesEnabled:!0,webhookEnabled:!1}}}function xe(){const l=o.useMemo(()=>B,[]),[i,t]=o.useState(()=>{var f;return v("copy.fx.trader.selectedPlanId.v1",((f=l[0])==null?void 0:f.planId)??"")}),s=o.useMemo(()=>l.find(f=>f.planId===i)??null,[l,i]);o.useEffect(()=>y("copy.fx.trader.selectedPlanId.v1",i),[i]);const[m,c]=o.useState(()=>v("copy.fx.trader.accounts.v1",[{id:4108,type:"MT5",label:"Main MT5",enabled:!0,isMaster:!0,userId:"12345678",createdAt:"2026-01-10T10:00:00.000Z",updatedAt:"2026-01-20T12:30:00.000Z"},{id:3748,type:"CTRADER",label:"cTrader 1",enabled:!0,isMaster:!1,userId:"10001234",hasToken:!0,createdAt:"2025-12-18T19:07:00.000Z",updatedAt:"2026-01-20T08:58:00.000Z"}]));o.useEffect(()=>y("copy.fx.trader.accounts.v1",m),[m]);const[n,a]=o.useState(()=>v("copy.fx.trader.planSignals.v1",{}));o.useEffect(()=>y("copy.fx.trader.planSignals.v1",n),[n]),o.useEffect(()=>{s!=null&&s.planId&&a(f=>$(s.planId,f))},[s==null?void 0:s.planId]);const[p,r]=o.useState(()=>v("copy.fx.trader.strategySelections.v1",{}));o.useEffect(()=>y("copy.fx.trader.strategySelections.v1",p),[p]);const h=o.useMemo(()=>s?(p[s.planId]??[]).length:0,[s,p]),[b,g]=o.useState(()=>v("copy.fx.trader.safety.v1",J));o.useEffect(()=>y("copy.fx.trader.safety.v1",b),[b]);const[N,x]=o.useState(!1),[d,j]=o.useState(!1),[D,A]=o.useState(!1),P=(s==null?void 0:s.limits.maxConnectedAccounts)??0;return o.useEffect(()=>{if(!s)return;const f=b[s.planId];f!=null&&f.killSwitch&&k.warn("Kill switch is ON (execution disabled)",{autoClose:2500})},[s,b]),e.jsxs("div",{className:R,children:[e.jsxs("div",{className:"mb-5",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-white",children:"Copy Trading • Forex (Trader)"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Accounts are priority. Configure plan → webhook/strategies → safety controls."})]}),e.jsx(W,{roleMode:"TRADER",maxAccounts:P||10,value:m,onChange:c}),e.jsx("div",{className:"mt-5",children:e.jsx(K,{plans:l,selectedPlanId:i,onChangePlan:t,accountsUsed:m.length,enabledStrategyCount:h,planSignals:n,onOpenWebhook:()=>x(!0),onOpenStrategies:()=>j(!0),onOpenSafety:()=>A(!0)})}),e.jsx(V,{open:N,onClose:()=>x(!1),plan:s,planSignals:n,setPlanSignals:a}),e.jsx(Z,{open:d,onClose:()=>j(!1),plan:s,strategyDefs:G,planSignals:n,setPlanSignals:a,selections:p,setSelections:r}),e.jsx(q,{open:D,onClose:()=>A(!1),plan:s,safety:b,setSafety:g})]})}export{xe as default};
