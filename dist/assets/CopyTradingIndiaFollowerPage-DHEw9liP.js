import{r as t,j as e}from"./index-_x4LqXeA.js";import{l as A,g as C,m as I,n as f,c as l,i as c,j as b,f as m,h as g,e as D}from"./storage-COxbdnGW.js";import{P as T}from"./plus-Dr61E6Gh.js";import{S as q}from"./save-CpCvopvD.js";function P(){const[r,u]=t.useState(""),[w,y]=t.useState(""),[o,p]=t.useState(()=>A("ct.india.followRequests.v1",[]));t.useEffect(()=>C("ct.india.followRequests.v1",o),[o]);const h="You",v=t.useMemo(()=>o.filter(s=>s.followerName===h),[o]),k=()=>{const s=r.trim().toUpperCase();if(!s)return;const n=new Date().toISOString();p(d=>[{id:`req_${Date.now()}`,masterId:s,followerName:h,followerEmail:"you@mail.com",status:"PENDING",createdAt:n,updatedAt:n},...d]),u("")},S=(s,n,d)=>{p(i=>i.map(a=>a.id===s?{...a,followerToken:n,followerAccountLabel:d,updatedAt:new Date().toISOString()}:a))};return e.jsxs("div",{className:I,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-xl font-semibold text-slate-100",children:"Copy Trading • India (Follower)"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Enter a Master ID shared by a trader. After approval, you can add your token/credentials."})]}),e.jsxs("div",{className:f,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"Follow a Master"}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Example: IND-CT-482913"})]}),e.jsxs("button",{type:"button",className:l(m,b),onClick:k,disabled:!r.trim(),children:[e.jsx(T,{size:16}),"Send Request"]})]}),e.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-300",children:"Master ID"}),e.jsx("input",{className:c,value:r,onChange:s=>u(s.target.value),placeholder:"IND-CT-XXXXXX"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-300",children:"Account label (optional)"}),e.jsx("input",{className:c,value:w,onChange:s=>y(s.target.value),placeholder:"My Dhan / My Kite"}),e.jsx("div",{className:"text-[11px] text-slate-500 mt-2",children:"You can add label later when adding token."})]})]})]}),e.jsxs("div",{className:l(f,"mt-6"),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"My Requests"}),v.length===0?e.jsx("div",{className:l(g,"p-4 mt-4 text-sm text-slate-300"),children:"No requests yet."}):e.jsx("div",{className:"mt-4 space-y-3",children:v.map(s=>{const d=s.status==="APPROVED",[i,a]=t.useState(s.followerToken??""),[j,N]=t.useState(s.followerAccountLabel??"");return e.jsxs("div",{className:l(g,"p-4"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:s.masterId}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Status: ",e.jsx("b",{className:"text-slate-200",children:s.status})]})]}),e.jsxs("div",{className:"text-[11px] text-slate-500",children:["Updated: ",new Date(s.updatedAt).toLocaleString()]})]}),d?e.jsxs("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-300",children:"Account label"}),e.jsx("input",{className:c,value:j,onChange:x=>N(x.target.value),placeholder:"My Dhan / My Kite"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-300",children:"Token / Credential"}),e.jsx("input",{className:c,value:i,onChange:x=>a(x.target.value),placeholder:"Paste token"})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:l(m,D),onClick:()=>{N(s.followerAccountLabel??""),a(s.followerToken??"")},children:"Reset"}),e.jsxs("button",{type:"button",className:l(m,b),onClick:()=>S(s.id,i,j),disabled:!i.trim(),children:[e.jsx(q,{size:16}),"Save Token"]})]}),e.jsx("div",{className:"md:col-span-2 text-[11px] text-slate-500",children:"After you save token, trader sees “token added” and copy execution can begin."})]}):e.jsx("div",{className:"mt-3 text-[11px] text-slate-500",children:"Waiting for trader approval. Once approved, token input appears here."})]},s.id)})})]})]})}export{P as default};
