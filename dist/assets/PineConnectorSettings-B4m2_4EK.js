import{w as Ae,r as l,j as e,y as c,s as H,X as De}from"./index-_x4LqXeA.js";import{S as pe,T as be}from"./ToggleRow-Bw-dx5bF.js";import{D as Re}from"./download-B9Ll9-Qf.js";import{P as Fe}from"./power-UR2-Hce3.js";import{R as Me}from"./refresh-cw-DbxyBI9D.js";import{P as Oe}from"./plus-Dr61E6Gh.js";import{C as xe}from"./crown-BIlIHcvw.js";import{S as _e}from"./save-CpCvopvD.js";import{T as Ue}from"./trash-2-BfimlZ-T.js";import{E as Le}from"./ellipsis-vertical-CaplzEpS.js";function k(r){return(r==null?void 0:r.data)??r}const Pe=Ae.enhanceEndpoints({addTagTypes:["ForexTraderUserDetails"]}).injectEndpoints({endpoints:r=>({getMyForexTraderDetails:r.query({query:()=>({url:"/forex-trader-user-details/me",method:"GET"}),transformResponse:a=>{const s=k(a),n=(s==null?void 0:s.rows)??(s==null?void 0:s.items)??(s==null?void 0:s.data)??s??[];return Array.isArray(n)?n:[]},providesTags:["ForexTraderUserDetails"]}),upsertMyForexTraderDetails:r.mutation({query:a=>({url:"/forex-trader-user-details/me",method:"PUT",body:a}),transformResponse:a=>{var s;return((s=k(a))==null?void 0:s.data)??k(a)},invalidatesTags:["ForexTraderUserDetails"]}),patchForexTraderDetailById:r.mutation({query:({id:a,patch:s})=>({url:`/forex-trader-user-details/${a}`,method:"PATCH",body:s}),transformResponse:a=>{var s;return((s=k(a))==null?void 0:s.data)??k(a)},invalidatesTags:["ForexTraderUserDetails"]}),deleteForexTraderDetailById:r.mutation({query:({id:a})=>({url:`/forex-trader-user-details/${a}`,method:"DELETE"}),transformResponse:a=>{var s;return((s=k(a))==null?void 0:s.data)??k(a)},invalidatesTags:["ForexTraderUserDetails"]})}),overrideExisting:!0}),{useGetMyForexTraderDetailsQuery:Be,useUpsertMyForexTraderDetailsMutation:ze,usePatchForexTraderDetailByIdMutation:Xe,useDeleteForexTraderDetailByIdMutation:We}=Pe;function Y(...r){return r.filter(Boolean).join(" ")}function qe({open:r,onClose:a,plan:s,strategyDefs:n,planSignals:x,setPlanSignals:w,selections:d,setSelections:g,uiDebugUnlockAll:h}){var S;const f=(s==null?void 0:s.planId)??"",u=((S=s==null?void 0:s.limits)==null?void 0:S.maxActiveStrategies)??0,y=f?x[f]:void 0,v=!!(y!=null&&y.strategiesEnabled),E=l.useMemo(()=>s?n.filter(i=>i.planId===s.planId&&i.market==="FOREX"):[],[s,n]),N=l.useMemo(()=>f?d[f]??[]:[],[d,f]),T=i=>{f&&w({...x,[f]:{...x[f]??{},strategiesEnabled:i}})},b=i=>{if(!s)return;if(!h&&u<=0){c.error("Your plan doesn't allow strategies.");return}const m=N;if(m.includes(i)){g({...d,[s.planId]:m.filter(I=>I!==i)});return}if(!h&&u===1){g({...d,[s.planId]:[i]});return}if(!h&&u>0&&m.length>=u){c.warning(`Max ${u} strategies allowed for this plan.`);return}g({...d,[s.planId]:[...m,i]})};return e.jsx(pe,{open:r,onClose:a,title:"Forex Strategies",subtitle:"Enable/disable built-in strategies for this plan. Webhook can also be enabled separately.",children:s?e.jsxs("div",{className:"space-y-4",children:[e.jsx(be,{label:"Enable Built-in Strategies",hint:"If OFF, built-in strategies won't execute for this plan.",value:v,onChange:T}),e.jsxs("div",{className:Y(v?"":"opacity-60 pointer-events-none"),children:[e.jsxs("div",{className:"text-xs text-slate-400 mb-2",children:["Enabled: ",e.jsx("span",{className:"text-slate-200 font-semibold",children:N.length})," /"," ",e.jsx("span",{className:"text-slate-200 font-semibold",children:u||0}),u===1?" • only one can be active":""]}),e.jsx("div",{className:"grid gap-3",children:E.length===0?e.jsx("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 text-xs text-slate-400",children:"No strategies configured for this plan (dummy)."}):E.map(i=>{var I;const m=N.includes(i.id),C=!h&&u>0&&u!==1&&!m&&N.length>=u;return e.jsx("button",{type:"button",onClick:()=>{if(C)return c.warning(`Max ${u} strategies allowed for this plan.`);b(i.id)},className:Y("text-left rounded-xl border p-4 transition",m?"border-emerald-500/30 bg-emerald-500/10":"border-white/10 bg-white/5 hover:bg-white/10",C&&"opacity-60 cursor-not-allowed"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:i.name}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:i.description}),(I=i.tags)!=null&&I.length?e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:i.tags.map(O=>e.jsx("span",{className:"text-[11px] rounded-full border border-white/10 bg-white/5 text-slate-300 px-2 py-1",children:O},O))}):null]}),e.jsx("span",{className:Y("text-[11px] rounded-full border px-2 py-1",m?"border-emerald-500/20 bg-emerald-500/10 text-emerald-200":"border-white/10 bg-white/5 text-slate-300"),children:m?"ENABLED":"DISABLED"})]})},i.id)})})]}),e.jsx("button",{type:"button",onClick:()=>c.success("Saved (dummy)"),className:"w-full rounded-xl border border-emerald-500/30 bg-emerald-500/15 text-emerald-200 hover:bg-emerald-500/20 px-4 py-3 text-sm font-semibold",children:"Save"})]}):e.jsx("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 text-xs text-slate-400",children:"Select a plan first."})})}function Ve(...r){return r.filter(Boolean).join(" ")}function Je(){return typeof window>"u"?"https://your-domain.com":window.location.origin||"https://your-domain.com"}function $e(){try{const r=new Uint8Array(16);return crypto.getRandomValues(r),Array.from(r).map(a=>a.toString(16).padStart(2,"0")).join("")}catch{return Math.random().toString(16).slice(2)+Math.random().toString(16).slice(2)}}async function Q(r){try{await navigator.clipboard.writeText(r),c.success("Copied")}catch{c.error("Copy failed")}}function Ge({open:r,onClose:a,plan:s,accounts:n,planSignals:x,setPlanSignals:w}){var S;const d=(s==null?void 0:s.planId)??"",g=d?x[d]:void 0,h=!!(g!=null&&g.webhookEnabled),f=l.useMemo(()=>`${Je()}/api/webhooks/tradingview/forex`,[]),u=l.useMemo(()=>{var C;if(!d)return"";const i=(C=x[d])==null?void 0:C.webhookSecret;if(i)return i;const m=$e();return w({...x,[d]:{...x[d]??{},webhookSecret:m}}),m},[d]),y=n.find(i=>i.isMaster),v=y!=null&&y.id?String(y.id):(S=n[0])!=null&&S.id?String(n[0].id):"",E=(g==null?void 0:g.webhookDefaultAccountId)??v,N=i=>{d&&w({...x,[d]:{...x[d]??{},webhookEnabled:i}})},T=i=>{d&&w({...x,[d]:{...x[d]??{},webhookDefaultAccountId:i}})},b=l.useMemo(()=>JSON.stringify({market:"FOREX",planId:d||"<PLAN_ID>",accountId:E||"<ACCOUNT_ID>",secret:u||"<SECRET>",symbol:"{{ticker}}",action:"{{strategy.order.action}}",volume:"{{strategy.order.contracts}}",price:"{{close}}",time:"{{time}}",comment:"{{strategy.order.comment}}",orderType:"MARKET"},null,2),[d,E,u]);return e.jsx(pe,{open:r,onClose:a,title:"Forex Webhook",subtitle:"Enable webhook for this plan and copy URL + JSON into TradingView alert.",children:s?e.jsxs("div",{className:"space-y-4",children:[e.jsx(be,{label:"Enable TradingView Webhook",hint:"If OFF, TradingView alerts won't trigger trades for this plan.",value:h,onChange:N}),e.jsxs("div",{className:Ve(h?"":"opacity-60"),children:[e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"Webhook URL"}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"TradingView Alert → Webhook URL"}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("input",{className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-3 py-2 text-sm text-slate-100",readOnly:!0,value:f}),e.jsx("button",{type:"button",className:"rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 px-3 py-2 text-sm text-slate-200",onClick:()=>Q(f),children:e.jsx(H,{size:16})})]})]}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"Secret"}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Validate this secret on backend."}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("input",{className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-3 py-2 text-sm text-slate-100",readOnly:!0,value:u||""}),e.jsx("button",{type:"button",className:"rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 px-3 py-2 text-sm text-slate-200",onClick:()=>Q(u||""),children:e.jsx(H,{size:16})})]})]}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"Default Account"}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Used in JSON template (prefer master)."}),e.jsxs("select",{className:"mt-2 w-full rounded-xl border border-white/10 bg-slate-950/40 px-3 py-2.5 text-sm text-slate-100 outline-none",value:E,onChange:i=>T(i.target.value),children:[n.length===0?e.jsx("option",{value:"",children:"No accounts added"}):null,n.map(i=>{var m;return e.jsxs("option",{value:String(i.id),children:[((m=i.forexType)==null?void 0:m.toUpperCase())||"FX"," • ",i.forexTraderUserId||i.id," ",i.isMaster?"• Master":""]},String(i.id))})]})]}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"TradingView JSON Message"}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"TradingView Alert → Message"})]}),e.jsx("button",{type:"button",className:"rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 px-3 py-2 text-sm text-slate-200",onClick:()=>Q(b),children:e.jsx(H,{size:16})})]}),e.jsx("pre",{className:"mt-3 rounded-xl border border-white/10 bg-black/30 p-3 text-[12px] text-slate-200 overflow-auto",children:b})]})]}),e.jsx("button",{type:"button",onClick:()=>c.success("Saved (dummy)"),className:"w-full rounded-xl border border-emerald-500/30 bg-emerald-500/15 text-emerald-200 hover:bg-emerald-500/20 px-4 py-3 text-sm font-semibold",children:"Save"})]}):e.jsx("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 text-xs text-slate-400",children:"Select a plan first."})})}const Ke=[{planId:"fx_basic",planName:"Forex Basic",endDate:"2026-12-31T23:59:59Z",executionAllowed:!0,limits:{maxConnectedAccounts:2,maxActiveStrategies:1,maxDailyTrades:50,maxLotPerTrade:1}},{planId:"fx_pro",planName:"Forex Pro",endDate:"2026-12-31T23:59:59Z",executionAllowed:!0,limits:{maxConnectedAccounts:5,maxActiveStrategies:2,maxDailyTrades:200,maxLotPerTrade:3}},{planId:"fx_elite",planName:"Forex Elite",endDate:"2026-12-31T23:59:59Z",executionAllowed:!0,limits:{maxConnectedAccounts:10,maxActiveStrategies:4,maxDailyTrades:500,maxLotPerTrade:10}}],Ze=[{id:"fx_basic_breakout",planId:"fx_basic",market:"FOREX",name:"Breakout Lite",description:"Simple breakout entries with conservative filters.",tags:["breakout","safe"]},{id:"fx_basic_reversion",planId:"fx_basic",market:"FOREX",name:"Mean Reversion Lite",description:"Range/reversion entries with tight risk.",tags:["reversion"]},{id:"fx_pro_momentum",planId:"fx_pro",market:"FOREX",name:"Momentum Pro",description:"Trend continuation momentum entries.",tags:["trend","momentum"]},{id:"fx_pro_scalp",planId:"fx_pro",market:"FOREX",name:"Scalp Pro",description:"Fast scalps. Needs max trades/day protection.",tags:["scalp","fast"]},{id:"fx_pro_reversion",planId:"fx_pro",market:"FOREX",name:"Reversion Pro",description:"Better sideways detection and entries.",tags:["reversion"]},{id:"fx_elite_smarttrend",planId:"fx_elite",market:"FOREX",name:"Smart Trend",description:"Adaptive trend entries across sessions.",tags:["trend"]},{id:"fx_elite_newsfilter",planId:"fx_elite",market:"FOREX",name:"News Filter Guard",description:"Avoid trades around high-impact windows.",tags:["guard"]},{id:"fx_elite_scalp",planId:"fx_elite",market:"FOREX",name:"Elite Scalp",description:"Higher frequency scalps (use strict limits).",tags:["scalp"]},{id:"fx_elite_reversion",planId:"fx_elite",market:"FOREX",name:"Elite Reversion",description:"Mean reversion with volatility bands.",tags:["reversion"]}];function j(...r){return r.filter(Boolean).join(" ")}const P=!1,He="w-full",ee="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 shadow-[0_0_0_1px_rgba(255,255,255,0.02)]",A="inline-flex items-center gap-2 rounded-xl px-4 py-2 text-xs font-semibold transition disabled:opacity-60 disabled:cursor-not-allowed",z="border border-slate-800 bg-slate-900/60 text-slate-200 hover:bg-slate-900/80",Ye="bg-indigo-500 text-white hover:bg-indigo-400",Qe="bg-yellow-400 text-slate-950 hover:bg-yellow-300",me="mt-2 w-full rounded-lg border border-slate-200/15 bg-slate-950/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 outline-none focus:border-emerald-400 focus:ring-1 focus:ring-emerald-400";function te(r,a){try{const s=localStorage.getItem(r);return s?JSON.parse(s):a}catch{return a}}function se(r,a){try{localStorage.setItem(r,JSON.stringify(a))}catch{}}function et(r,a){return a[r]?a:{...a,[r]:{strategiesEnabled:!0,webhookEnabled:!1}}}function ue(r){if(!r)return"—";try{const a=new Date(r);return new Intl.DateTimeFormat("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch{return"—"}}function tt({checked:r,onChange:a,disabled:s}){return e.jsx("button",{type:"button",disabled:s,onClick:()=>a(!r),className:j("relative h-6 w-11 rounded-full border transition",r?"bg-emerald-500/90 border-emerald-400":"bg-slate-800 border-slate-700",s&&"opacity-60 cursor-not-allowed"),"aria-pressed":r,children:e.jsx("span",{className:j("absolute top-[3px] h-4 w-4 rounded-full bg-slate-950 transition",r?"left-6":"left-[3px]")})})}function st({open:r,title:a,onClose:s,children:n}){return r?e.jsxs("div",{className:"fixed inset-0 z-[80]",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:s}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-[440px] bg-white text-slate-900 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b",children:[e.jsx("p",{className:"text-base font-semibold",children:a}),e.jsx("button",{type:"button",onClick:s,className:"rounded-lg p-2 hover:bg-slate-100",children:e.jsx(De,{size:18})})]}),e.jsx("div",{className:"p-5",children:n})]})]}):null}function rt({onEdit:r,onDelete:a}){const[s,n]=l.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>n(x=>!x),className:"rounded-lg p-2 hover:bg-slate-100/10",children:e.jsx(Le,{size:18,className:"text-slate-400"})}),s?e.jsxs("div",{className:"absolute right-0 top-10 w-40 rounded-xl border border-slate-200 bg-white shadow-lg overflow-hidden",children:[e.jsx("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-slate-100",onClick:()=>{n(!1),r()},children:"Edit"}),e.jsx("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-slate-100 text-rose-600",onClick:()=>{n(!1),a()},children:"Delete"})]}):null]})}function pt(){var de,ce;const r=l.useMemo(()=>Ke,[]),[a,s]=l.useState(()=>{var t;return te("fx.selectedPlanId.v1",((t=r[0])==null?void 0:t.planId)??"")});l.useEffect(()=>se("fx.selectedPlanId.v1",a),[a]);const n=l.useMemo(()=>r.find(t=>t.planId===a)??null,[r,a]),[x,w]=l.useState(()=>te("fx.planSignals.v1",{}));l.useEffect(()=>se("fx.planSignals.v1",x),[x]),l.useEffect(()=>{n!=null&&n.planId&&w(t=>et(n.planId,t))},[n==null?void 0:n.planId]);const[d,g]=l.useState(()=>te("fx.strategySelections.v1",{}));l.useEffect(()=>se("fx.strategySelections.v1",d),[d]);const h=n!=null&&n.planId?x[n.planId]:void 0,f=!!(h!=null&&h.strategiesEnabled),u=!!(h!=null&&h.webhookEnabled),y=l.useMemo(()=>n?(d[n.planId]??[]).length:0,[n,d]),{data:v,isLoading:E,isFetching:N,refetch:T}=Be(void 0),b=l.useMemo(()=>{const t=(v==null?void 0:v.data)??v??[];return Array.isArray(t)?t:[]},[v]),S=b.length,i=(de=n==null?void 0:n.limits)==null?void 0:de.maxConnectedAccounts,m=typeof i=="number"?S>=i:!1,[C,{isLoading:I}]=ze(),[O,{isLoading:X}]=Xe(),[he,{isLoading:W}]=We(),[fe,re]=l.useState(!1),[ge,ae]=l.useState(!1),[je,D]=l.useState(!1),[R,ne]=l.useState("CREATE"),[B,ie]=l.useState(null),[F,q]=l.useState("MT5"),[V,J]=l.useState(!0),[_,$]=l.useState(""),[U,G]=l.useState(""),[K,Z]=l.useState({});l.useEffect(()=>{const t={};b.forEach(p=>{const o=String(p.id);t[o]=K[o]??!0}),Z(t)},[b.length]);const oe=b.length>0&&b.every(t=>K[String(t.id)]!==!1),ye=()=>{const t=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),p=URL.createObjectURL(t),o=document.createElement("a");o.href=p,o.download="forex_accounts_export.json",o.click(),URL.revokeObjectURL(p)},ve=()=>{const t=!oe,p={};b.forEach(o=>p[String(o.id)]=t),Z(p),c.success(t?"All accounts turned ON":"All accounts turned OFF")},M=()=>{q("MT5"),J(!0),$(""),G(""),ie(null)},we=()=>{if(m&&!P){c.error("Account limit reached for your plan");return}M(),ne("CREATE"),D(!0)},Ne=t=>{M(),ne("EDIT"),ie(Number(t.id)),q(String(t.forexType).toUpperCase()),J(!!t.isMaster),$(String(t.forexTraderUserId??"")),G(""),D(!0)},Te=async()=>{var t,p;if(R==="CREATE"){if(m&&!P)return c.error("Account limit reached for your plan");try{const o=String(F).toUpperCase();if(!_.trim())return c.error(o==="MT5"?"MT5 Login ID is required":"cTrader Account ID is required");if(o==="CTRADER"&&!U.trim())return c.error("cTrader Access Token is required");await C({forexType:o==="CTRADER"?"CTRADER":"MT5",forexTraderUserId:_.trim(),token:o==="CTRADER"?U.trim():void 0,isMaster:V}).unwrap(),c.success("Saved"),D(!1),M(),T()}catch(o){c.error(((t=o==null?void 0:o.data)==null?void 0:t.message)||"Failed to save")}return}if(B)try{if(!_.trim())return c.error("User ID is required");const o=String(F).toUpperCase()==="CTRADER",L={forexTraderUserId:_.trim(),isMaster:V};o&&U.trim()&&(L.token=U.trim()),await O({id:B,patch:L}).unwrap(),c.success("Updated"),D(!1),M(),T()}catch(o){c.error(((p=o==null?void 0:o.data)==null?void 0:p.message)||"Failed to update")}},Ee=async t=>{var p;try{await O({id:t,patch:{isMaster:!0}}).unwrap(),c.success("Master set"),T()}catch(o){c.error(((p=o==null?void 0:o.data)==null?void 0:p.message)||"Failed")}},le=async t=>{var p;try{await he({id:t}).unwrap(),c.success("Deleted"),T()}catch(o){c.error(((p=o==null?void 0:o.data)==null?void 0:p.message)||"Failed")}},Se=l.useMemo(()=>b.map(t=>({id:t.id,forexType:t.forexType,forexTraderUserId:t.forexTraderUserId,isMaster:!!t.isMaster})),[b]);return e.jsxs("div",{className:He,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap mb-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl font-semibold text-slate-100",children:"Forex Accounts"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Plan:"}),e.jsx("select",{value:a,onChange:t=>s(t.target.value),className:"rounded-lg border border-slate-200/15 bg-slate-950/40 px-3 py-2 text-xs text-slate-100 outline-none",children:r.map(t=>e.jsx("option",{value:t.planId,children:t.planName},t.planId))}),e.jsxs("span",{className:j("inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-[11px]",f?"text-emerald-200 bg-emerald-500/10 border-emerald-500/20":"text-slate-200 bg-white/5 border-white/10"),children:["Strategies: ",f?"ON":"OFF"," (",y,"/",((ce=n==null?void 0:n.limits)==null?void 0:ce.maxActiveStrategies)??"—",")"]}),e.jsxs("span",{className:j("inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-[11px]",u?"text-emerald-200 bg-emerald-500/10 border-emerald-500/20":"text-slate-200 bg-white/5 border-white/10"),children:["Webhook: ",u?"ON":"OFF"]})]}),e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Accounts used: ",e.jsx("span",{className:"text-slate-200 font-semibold",children:S}),typeof i=="number"?e.jsxs(e.Fragment,{children:[" ","/ ",e.jsx("span",{className:"text-slate-200 font-semibold",children:i})]}):null,m&&!P?e.jsx("span",{className:"ml-2 text-amber-300",children:"Plan limit reached"}):null]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{type:"button",onClick:()=>ae(!0),className:j(A,z),children:"Webhook"}),e.jsx("button",{type:"button",onClick:()=>re(!0),className:j(A,z),children:"Strategies"}),e.jsxs("button",{type:"button",onClick:ye,className:j(A,z),children:[e.jsx(Re,{size:14}),"Export"]}),e.jsxs("button",{type:"button",onClick:ve,disabled:b.length===0,className:j(A,oe?"border border-rose-400/30 bg-rose-500/15 text-rose-200 hover:bg-rose-500/20":"border border-emerald-400/30 bg-emerald-500/15 text-emerald-200 hover:bg-emerald-500/20"),children:[e.jsx(Fe,{size:14}),"ALL API ON / OFF"]}),e.jsxs("button",{type:"button",onClick:()=>T(),className:j(A,z),children:[e.jsx(Me,{size:14,className:N?"animate-spin":""}),N?"Refreshing...":"Refresh"]}),e.jsxs("button",{type:"button",onClick:we,disabled:m&&!P,className:j(A,Ye),children:[e.jsx(Oe,{size:14}),"Add New"]})]})]}),E?e.jsx("div",{className:ee,children:"Loading…"}):b.length===0?e.jsxs("div",{className:ee,children:[e.jsx("p",{className:"text-slate-200 font-semibold",children:"No accounts added yet."}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Click “Add New” to connect MT5 or cTrader."})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:b.map(t=>{const p=Number(t.id),o=String(t.id),L=String(t.forexType).toUpperCase()==="CTRADER",Ce=K[o]!==!1;return e.jsxs("div",{className:ee,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-base font-semibold text-slate-100",children:L?"cTrader":"MT5"}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Account :"}),e.jsx("p",{className:"text-sm text-slate-200 font-medium truncate",children:t.forexTraderUserId}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[t.isMaster?e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-yellow-400/15 px-2.5 py-1 text-[11px] text-yellow-200",children:[e.jsx(xe,{size:12})," Master"]}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900/60 border border-slate-800 px-2.5 py-1 text-[11px] text-slate-200",children:"Child"}),L?e.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-900/60 border border-slate-800 px-2.5 py-1 text-[11px] text-slate-200",children:["hasToken: ",t.hasToken?"yes":"no"]}):null]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{checked:Ce,onChange:Ie=>Z(ke=>({...ke,[o]:Ie}))}),e.jsx(rt,{onEdit:()=>Ne(t),onDelete:()=>le(p)})]})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-slate-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Created :"}),e.jsx("span",{children:ue(t.createdAt)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Updated :"}),e.jsx("span",{children:ue(t.updatedAt)})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-lg border border-indigo-300/30 bg-indigo-500/10 px-3 py-1 text-xs text-indigo-200",children:["Id : ",String(t.id)]}),t.isMaster?null:e.jsxs("button",{type:"button",onClick:()=>Ee(p),disabled:X,className:j(A,Qe,"px-3 py-2"),children:[e.jsx(xe,{size:14}),"Set Master"]})]})]},o)})}),e.jsx(st,{open:je,title:R==="CREATE"?"Add New Account":"Edit Account",onClose:()=>{D(!1),M()},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-indigo-600",children:"SELECT TYPE"}),e.jsxs("select",{value:F,onChange:t=>q(t.target.value),className:"mt-2 w-full rounded-lg border border-indigo-300 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-indigo-200",disabled:R==="EDIT",children:[e.jsx("option",{value:"MT5",children:"MT5"}),e.jsx("option",{value:"CTRADER",children:"cTrader"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-600",children:"ROLE"}),e.jsxs("div",{className:"mt-2 flex items-center gap-3 text-sm",children:[e.jsx("input",{type:"checkbox",checked:V,onChange:t=>J(t.target.checked),className:"h-4 w-4"}),"isMaster (unchecked = Child)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-600",children:String(F).toUpperCase()==="CTRADER"?"CTRADER ACCOUNT ID":"MT5 LOGIN ID"}),e.jsx("input",{className:me.replace("mt-2",""),value:_,onChange:t=>$(t.target.value),placeholder:String(F).toUpperCase()==="CTRADER"?"cTrader Account ID":"MT5 Login ID"})]}),String(F).toUpperCase()==="CTRADER"?e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-600",children:["CTRADER ACCESS TOKEN"," ",R==="EDIT"?e.jsx("span",{className:"text-[11px] text-slate-400",children:"(optional — leave blank to keep existing)"}):null]}),e.jsx("input",{className:me.replace("mt-2",""),value:U,onChange:t=>G(t.target.value),placeholder:"Paste access token"})]}):null,e.jsxs("div",{className:"pt-2 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:Te,disabled:I||X||W,className:"rounded-lg bg-indigo-500 px-6 py-2 text-sm font-semibold text-white hover:bg-indigo-400 disabled:opacity-60",children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(_e,{size:16}),R==="CREATE"?I?"Saving...":"Submit":X?"Saving...":"Save Changes"]})}),e.jsx("button",{type:"button",onClick:()=>{D(!1),M()},className:"rounded-lg bg-rose-100 px-6 py-2 text-sm font-semibold text-rose-600 hover:bg-rose-200",children:"Cancel"})]}),R==="EDIT"&&B?e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("button",{type:"button",onClick:()=>le(B),disabled:W,className:"inline-flex items-center gap-2 rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-500 disabled:opacity-60",children:[e.jsx(Ue,{size:16}),W?"Deleting...":"Delete this account"]})}):null]})}),e.jsx(Ge,{open:ge,onClose:()=>ae(!1),plan:n,accounts:Se,planSignals:x,setPlanSignals:w}),e.jsx(qe,{open:fe,onClose:()=>re(!1),plan:n,strategyDefs:Ze,planSignals:x,setPlanSignals:w,selections:d,setSelections:g,uiDebugUnlockAll:P})]})}export{pt as default};
